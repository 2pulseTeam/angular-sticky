/*
 * angular-sticky
 * https://github.com/harm-less/angular-sticky

 * Version: 0.0.4 - 2016-03-12
 * License: MIT
 */"use strict";angular.module("hl.sticky",[]).factory("mediaQuery",function(){return{matches:function(a){return a&&(matchMedia("("+a+")").matches||matchMedia(a).matches)}}}).factory("hlStickyStack",function(a,b){function c(a){a=a||{};var c=a.name||b;if(e[c])return e[c];var f=1039,g=[],h={};return h.options=a,h.stackName=c,h.add=function(a,b){return angular.isString(a)&&""!==a||(a=h.length()),b.id=a,b.zIndex=f,g.push(b),f-=1,b},h.get=function(a){for(var b=0;b<g.length;b++)if(a==g[b].id)return g[b];return!1},h.index=function(a){for(var b=0;b<g.length;b++)if(a==g[b].id)return b;return-1},h.range=function(a,b){return g.slice(a,b)},h.all=function(){return g},h.keys=function(){for(var a=[],b=0;b<g.length;b++)a.push(g[b].id);return a},h.top=function(){return g[g.length-1]},h.remove=function(a){for(var b=0;b<g.length;b++)if(a==g[b].id)return f+=1,g.splice(b,1)[0];return!1},h.removeTop=function(){return g.splice(g.length-1,1)[0]},h.length=function(){return g.length},h.height=function(a){var b=0;return angular.forEach(g,function(c){b+=c.computedHeight(a)}),b},h.totalHeightAt=function(a,b){for(var c,d,e=b-1,f=0,h=0;h<g.length;h++)c=g[h],c.sticksAtPosition(a,e)&&(d=c.computedHeight(a,e-f),f+=d,b-=d);return f},h.totalHeightCurrent=function(a){return h.totalHeightAt(a,window.pageYOffset||d.scrollTop)},e[c]=h,h}var d=a[0].documentElement,e={};return c}).factory("hlStickyElement",function(a,b,c,d,e){return function(d,f){function g(){return B?y:y=r(D)-I-u()}function h(){return B?z:z=s(D)-J-v()}function i(a,c){if(!l())return!1;switch(a){case"top":return j(c);case"bottom":return k(c);default:b.error('Unknown anchor "'+a+'"')}return!1}function j(a){a=void 0!==a?a:window.pageYOffset||C.scrollTop();var b=a-(E.clientTop||0);return b>=g()}function k(a){a=void 0!==a?a:window.pageYOffset||C.scrollTop();var b=a+window.innerHeight;return b<=h()}function l(){return F===!1||e.matches(F)}function m(){var a=i(K);a&&!B?n():!a&&B&&o(),B&&"top"===K&&(d.css("top",I+t(K)-x()+"px"),d.css("width",p()+"px"))}function n(){B=!0,d.addClass(G);var a=D.getBoundingClientRect(),b={width:p()+"px",position:"fixed",left:a.left+"px","z-index":M.get(Q).zIndex-(N.zIndex||0)};b["margin-"+K]=0,d.css(b),H&&(A=A||angular.element("<div>"),A.css("height",q()+"px"),d.after(A))}function o(){B=!1,d.removeClass(G),d.attr("style",O.style),A&&A.remove()}function p(){return D.offsetWidth}function q(){return D.offsetHeight}function r(a){var b=0;if(a&&a.offsetParent)do b+=a.offsetTop,a=a.offsetParent;while(a);return b}function s(a){return a.offsetTop+a.clientHeight}function t(a){var b=M.index(Q),c=0;return"top"===a&&N.top>0&&(c+=N.top),b>0&&M.range(0,b).forEach(function(b){c+=b.computedHeight(a)}),c}function u(){return t("top")}function v(){return t("bottom")}function w(a,b){return"top"===a?Math.max(0,q()-x(b)+I):0}function x(a){if(null===L&&(L=void 0!==f.container?angular.isString(f.container)?$("#"+f.container)[0]:f.container:!1),L){var b=!(null===a||void 0===a),c=L.getBoundingClientRect(),d=b?r(L)+c.height-a:c.bottom;return Math.max(0,I+t(K)+q()-d)}return 0}f=f||{};var y,z,A,B=!1,C=angular.element(a[0].body),D=d[0],E=a[0].documentElement,F=angular.isDefined(f.mediaQuery)?f.mediaQuery:!1,G=angular.isString(f.stickyClass)&&""!==f.stickyClass?f.stickyClass:"is-sticky",H=angular.isDefined(f.usePlaceholder)?f.usePlaceholder:!0,I=f.offsetTop?parseInt(f.offsetTop):0,J=f.offsetBottom?parseInt(f.offsetBottom):0,K="string"==typeof f.anchor?f.anchor.toLowerCase().trim():"top",L=null,M=f.stack||c(),N={top:0,bottom:0},O={style:d.attr("style")||""},P=M.add(f.id,{width:p,height:q,computedHeight:w,sticksAtPosition:i}),Q=P.id,R={};return R.draw=function(a){a=a||{};var b=a.offset;b&&(N.top=b.top||0,N.bottom=b.bottom||0,N.zIndex=b.zIndex),a.force===!0&&o(),m()},R.destroy=function(){o(),M.remove(Q)},R}}).constant("DefaultStickyStackName","default-stack").provider("hlStickyElementCollection",function(){var a=0,b={collections:{},defaults:{checkDelay:250},elementsDefaults:{},$get:function(c,d,e,f,g,h,i,j){function k(){a++,a>1||(s=j(n,b.defaults.checkDelay,{leading:!1}),t.on("resize",s),t.on("scroll",m),q=c.$on("$viewContentLoaded",s),r=c.$on("$includeContentLoaded",s),s())}function l(){a--,a>0||(t.off("resize",s),t.off("scroll",m),q(),r())}function m(){o()}function n(){o({force:!0})}function o(a){angular.forEach(b.collections,function(b){b.draw(a)})}function p(a){a&&angular.isObject(a)||(f.warn("Must supply an options object"),a={}),a=angular.extend({},b.elementsDefaults,a);var c=a.name||g;if(b.collections[c])return b.collections[c];var d=i({name:c}),e=[],j={};return j.addElement=function(a,b){b=b||{},b.addScrollEvent=!1,b.stack=d;var c=h(a,b);return e.push({stickyElement:c,element:a}),c},j.removeElement=function(a){for(var b,c=e.length;c--;)if(angular.isString(a)&&"#"+e[c].element.id===a||e[c].element===a){b=c;break}var d=e.splice(b,1)[0];return d.stickyElement.destroy(),d},j.draw=function(b){var c={};if(a.parent){var d=i({name:a.parent});c.offset={top:d.totalHeightCurrent("top"),zIndex:d.length()}}angular.extend(c,b||{}),angular.forEach(e,function(a){a.stickyElement.draw(c)})},j.destroy=function(a){(a===!0||0===e.length)&&(delete b.collections[c],l())},j.trackedElements=function(){return e},b.collections[c]=j,k(),j}var q,r,s,t=angular.element(d);return p}};return b}).directive("hlSticky",function(a,b,c,d){return{restrict:"A",transclude:!0,replace:!0,template:'<div class="hl-sticky" ng-transclude></div>',link:function(a,b,c){var e=b,f=d({name:c.collection,parent:c.collectionParent});f.addElement(e,{id:c.hlSticky||c.stickyId,mediaQuery:c.mediaQuery,stickyClass:c.stickyClass,usePlaceholder:c.usePlaceholder,offsetTop:c.offsetTop,offsetBottom:c.offsetBottom,anchor:c.anchor,container:c.container}),a.$on("$destroy",function(){f.removeElement(e),f.destroy()})}}}).factory("throttle",function(a){return function(b,c,d){var e=null;return d=d||{},function(){var f=this,g=arguments;e||(d.leading!==!1&&b.apply(f,g),e=a(function(){e=null,d.trailing!==!1&&b.apply(f,g)},c,!1))}}});